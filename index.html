<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Biblia Pro - Quiz & Studiu</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a2a6c">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Lora:wght@400;600&display=swap" rel="stylesheet">
    
    <script src="data/cornilescu.js"></script>

    <style>
        :root { --p: #1a2a6c; --a: #b21f1f; --s: #28a745; --bg: #f4f7f6; --card: #ffffff; --txt: #2c3e50; }
        
        body.dark-theme { 
            --bg: #121212; 
            --card: #1e1e1e; 
            --txt: #e0e0e0; 
            --p: #4facfe; 
            background-color: #121212 !important;
        }

        /* FIX VIZIBILITATE MOD NOCTURN */
        body.dark-theme #lista-salvate .text-muted,
        body.dark-theme .tab-pane#saved p.text-muted,
        body.dark-theme #stare-rezultat,
        body.dark-theme .text-muted {
            color: #bbbbbb !important;
        }

        body.dark-theme #stare-rezultat-container {
            background: rgba(255, 255, 255, 0.05) !important;
        }

        body.dark-theme .ref-link {
            color: #ff4d4d !important;
        }

        /* ASIGURARE CONTRAST BUTOANE QUIZ */
        .quiz-btn[style*="background: rgb(212, 237, 218)"], 
        .quiz-btn[style*="background: #d4edda"],
        .quiz-btn[style*="background: #28a745"] {
            color: white !important; 
        }

        .quiz-btn[style*="background: rgb(248, 215, 218)"],
        .quiz-btn[style*="background: #f8d7da"],
        .quiz-btn[style*="background: #dc3545"] {
            color: white !important;
        }

        body, html { background: var(--bg); margin: 0; padding: 0; font-family: 'Lora', serif; overflow-x: hidden; transition: 0.3s; color: var(--txt); min-height: 100vh; }
        
        /* STILURI ECRAN BUN VENIT */
        #welcome-screen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            transition: transform 0.8s cubic-bezier(0.77, 0, 0.175, 1);
        }

        .welcome-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            padding: 40px 25px;
            border-radius: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            max-width: 350px;
            width: 90%;
            animation: fadeInScale 0.8s ease-out;
        }

        .btn-welcome {
            background: white;
            color: #1a2a6c;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-weight: bold;
            margin: 10px 0;
            width: 100%;
            transition: 0.3s;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            font-family: 'Montserrat';
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-welcome:hover { transform: translateY(-3px); box-shadow: 0 15px 25px rgba(0,0,0,0.2); }

        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        #main-app-content { opacity: 0; transition: 0.5s; }

        header { background: white; padding: 12px; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 1000; transition: 0.3s; }
        body.dark-theme header { background: #1e1e1e; border-bottom: 1px solid #333; }
        .nav-custom { background: white; border-radius: 50px; padding: 3px; display: inline-flex; box-shadow: 0 2px 8px rgba(0,0,0,0.05); margin: 15px auto; transition: 0.3s; }
        body.dark-theme .nav-custom { background: #1e1e1e; }
        .nav-link { border-radius: 50px !important; font-weight: bold; color: #666; padding: 7px 12px !important; font-size: 0.75rem; border: none !important; }
        .nav-link.active { background: var(--p) !important; color: white !important; }
        .card-premium { background: var(--card); border-radius: 20px; padding: 20px; box-shadow: 0 5px 20px rgba(0,0,0,0.05); margin-bottom: 15px; border: none; color: var(--txt); transition: 0.3s; }
        .v-zilei-box { background: linear-gradient(135deg, #1a2a6c, #b21f1f); color: white !important; border-radius: 25px; position: relative; overflow: hidden; }
        .v-zilei-box p { color: white !important; z-index: 2; position: relative; }
        #citire-text { line-height: 1.8; max-height: 60vh; overflow-y: auto; text-align: justify; scroll-behavior: smooth; font-size: 1rem; }
        .verset-wrapper { display: inline; position: relative; padding: 2px 0; }
        .verset-wrapper.highlight { background-color: #fff3cd; color: #333; }
        body.dark-theme .verset-wrapper.highlight { background-color: #443e20; color: #fff; }
        .quiz-btn { padding: 12px !important; margin-bottom: 10px; border-radius: 12px !important; width: 100%; transition: 0.2s; border: 2px solid #eee; font-weight: bold !important; background: var(--card); text-align: left; color: var(--txt); }
        .btn-circle { width: 35px; height: 35px; border-radius: 50%; border: none; background: var(--p); color: white; display: flex; align-items: center; justify-content: center; font-size: 0.8rem; }
        .ref-link { text-decoration: underline; cursor: pointer; color: var(--a); font-weight: bold; font-size: 0.75rem; }
        .history-item { border-radius: 15px; padding: 12px; margin-bottom: 10px; border-left: 5px solid transparent; background: rgba(0,0,0,0.02); transition: 0.2s; }
        body.dark-theme .history-item { background: rgba(255,255,255,0.03); }
        .history-correct { border-left-color: var(--s); }
        .history-wrong { border-left-color: var(--a); }
        .diff-btn { border: 2px solid #eee; background: var(--card); border-radius: 15px; padding: 15px; width: 100%; margin-bottom: 10px; transition: 0.3s; font-weight: bold; color: var(--txt); }
        .diff-btn:hover { border-color: var(--p); transform: translateY(-2px); }
        .timer-box { font-family: monospace; font-weight: bold; color: var(--a); font-size: 0.9rem; }
        .score-box { color: var(--s); font-weight: bold; }
        
        #search-results-box { max-height: 250px; overflow-y: auto; background: rgba(0,0,0,0.03); border-radius: 15px; margin-top: 10px; padding: 10px; display: none; border: 1px dashed var(--p); }
        body.dark-theme #search-results-box { background: rgba(255,255,255,0.05); }
        .search-item { padding: 8px; border-bottom: 1px solid rgba(0,0,0,0.05); cursor: pointer; }
        .search-item:last-child { border-bottom: none; }
        mark { background: #fff3cd; padding: 0; }

        .fade-in-v { animation: fadeInV 0.5s ease; }
        @keyframes fadeInV { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* --- STILURI NOI (1, 2, 4) --- */
        .progress-container { height: 8px; background: #e9ecef; border-radius: 10px; margin: 10px 0; overflow: hidden; }
        .progress-bar { background: linear-gradient(90deg, var(--s), #88d08b); transition: width 0.5s ease; }
        .card-night { background: linear-gradient(135deg, #232526, #414345); color: white !important; border: none; display: none; }
        .note-input { border: 1px dashed #ccc; background: rgba(0,0,0,0.02); font-size: 0.8rem; width: 100%; margin-top: 10px; padding: 5px; border-radius: 5px; }
        body.dark-theme .note-input { background: rgba(255,255,255,0.05); color: white; }
    </style>
</head>
<body>

<div id="welcome-screen">
    <div class="welcome-card">
        <h2 style="font-family: 'Montserrat'; font-weight: 800; letter-spacing: 2px;">BIBLIA <span style="color: #fdbb2d;">PRO</span></h2>
        <p class="mb-4 opacity-75" style="font-size: 0.8rem;">Creat de Alex Zaha</p>
        <hr style="border-color: rgba(255,255,255,0.2)">
        <h6 class="my-4" style="font-family: 'Montserrat';">Ce vrei sÄƒ faci azi?</h6>
        <div class="d-flex flex-column gap-2">
            <button class="btn-welcome" onclick="goToFeature('read')">
                <i class="fas fa-book-open me-2"></i> CITIRE
            </button>
            <button class="btn-welcome" onclick="goToFeature('quiz')">
                <i class="fas fa-gamepad me-2"></i> QUIZ
            </button>
        </div>
    </div>
</div>

<div id="main-app-content">
    <header class="d-flex justify-content-between align-items-center px-3">
        <div style="width: 40px;"></div>
        <h6 style="color: var(--p); font-family: 'Montserrat'; margin: 0; font-weight: 800; letter-spacing: 1px;">BIBLIA <span style="color: var(--a);">PRO</span></h6>
        <button onclick="toggleTheme()" class="btn btn-sm p-0" style="width: 40px; color: var(--p);"><i class="fas fa-moon"></i></button>
    </header>

    <div class="container py-2 text-center">
        <div class="nav-custom shadow-sm">
            <ul class="nav nav-pills" id="pills-tab">
                <li class="nav-item"><button class="nav-link active" id="btn-daily" data-bs-toggle="pill" data-bs-target="#daily">ASTÄ‚ZI</button></li>
                <li class="nav-item"><button class="nav-link" id="btn-read" data-bs-toggle="pill" data-bs-target="#read" onclick="initRead()">CITIRE</button></li>
                <li class="nav-item"><button class="nav-link" id="btn-saved" data-bs-toggle="pill" data-bs-target="#saved" onclick="afiseazaSalvate()">SALVATE</button></li>
                <li class="nav-item"><button class="nav-link" id="btn-quiz" data-bs-toggle="pill" data-bs-target="#quiz">QUIZ</button></li>
            </ul>
        </div>

        <div class="tab-content text-start">
            <div class="tab-pane fade show active" id="daily">
                <div class="card-premium v-zilei-box text-center shadow-lg">
                    <i class="fas fa-quote-left mb-3" style="opacity: 0.3; font-size: 2rem;"></i>
                    <p id="rand-text" style="font-size: 1.2rem; font-style: italic;">Se Ã®ncarcÄƒ...</p>
                    <h6 id="rand-ref" class="fw-bold mt-2"></h6>
                    <div class="d-flex justify-content-center gap-2 mt-3">
                        <button onclick="genereazaVerset()" class="btn btn-sm btn-light rounded-pill px-3 shadow-sm"><i class="fas fa-sync me-1"></i> ALTUL</button>
                        <button onclick="copyVerse()" class="btn btn-sm btn-outline-light rounded-pill px-3"><i class="fas fa-share me-1"></i> SHARE</button>
                    </div>
                </div>

                <div class="card-premium mt-3 shadow-sm">
                    <h6 class="fw-bold mb-1" style="font-size: 0.8rem; color: var(--p);">PROGRES BIBLIE</h6>
                    <div class="progress-container">
                        <div id="biblie-progres-bar" class="progress-bar" style="width: 0%"></div>
                    </div>
                    <small id="progres-text" class="text-muted" style="font-size: 0.7rem;">0 capitole citite</small>
                </div>

                <div class="card-premium mt-3 shadow-sm" style="background: var(--card); border: 1px solid rgba(0,0,0,0.05);">
                    <h6 class="fw-bold mb-3" style="font-family: 'Montserrat', sans-serif; font-size: 0.85rem; color: var(--p);">
                        <i class="fas fa-heart me-2 text-danger"></i>CUM TE SIMÈšI AZI?
                    </h6>
                    <div class="d-flex flex-wrap gap-2">
                        <button class="btn btn-sm btn-outline-primary rounded-pill px-3" onclick="vStare('neliniÈ™tit')">NeliniÈ™tit</button>
                        <button class="btn btn-sm btn-outline-danger rounded-pill px-3" onclick="vStare('trist')">Trist</button>
                        <button class="btn btn-sm btn-outline-success rounded-pill px-3" onclick="vStare('recunoscÄƒtor')">RecunoscÄƒtor</button>
                        <button class="btn btn-sm btn-outline-warning rounded-pill px-3" onclick="vStare('obosit')">Obosit</button>
                    </div>
                    <div id="stare-rezultat-container" class="mt-3 d-none">
                        <div id="stare-rezultat" class="small fst-italic text-muted" style="border-left: 3px solid var(--p); padding-left: 12px; line-height: 1.5; background: rgba(0,0,0,0.03); padding: 10px; border-radius: 0 10px 0 0;"></div>
                        <div class="d-flex justify-content-end" style="background: rgba(0,0,0,0.03); border-radius: 0 0 10px 10px; padding: 5px 10px;">
                            <button id="btn-alt-verset-stare" class="btn btn-sm text-primary fw-bold p-0" style="font-size: 0.75rem;">
                                <i class="fas fa-sync-alt me-1"></i> VEZI ALTUL
                            </button>
                        </div>
                    </div>
                </div>

                <div id="card-noapte" class="card-premium mt-3 shadow-sm card-night text-center">
                    <i class="fas fa-moon mb-2" style="color: #f1c40f;"></i>
                    <h6 class="fw-bold" style="font-family: 'Montserrat';">GÃ¢nd de Noapte BunÄƒ</h6>
                    <p id="text-noapte" class="small fst-italic mb-0" style="color: #ddd !important;"></p>
                </div>

                <div class="card-premium mt-3 shadow-sm text-center">
                    <h6 class="fw-bold mb-3" style="font-family: 'Montserrat', sans-serif; font-size: 0.85rem; color: var(--p);">
                        <i class="fas fa-bell me-2 text-warning"></i>REAMINTIRE ZILNICÄ‚
                    </h6>
                    <div class="d-flex flex-column align-items-center gap-2">
                        <span class="small text-muted">PrimeÈ™te un verset la ora aleasÄƒ:</span>
                        <input type="time" id="oraNotificare" class="form-control form-control-sm shadow-sm" style="max-width: 120px; text-align: center; border-radius: 10px; border: 1px solid var(--p);">
                        <button id="btn-notificare" onclick="activeazaNotificari()" class="btn btn-sm btn-primary rounded-pill px-4 mt-2">
                            ACTIVEAZÄ‚ NOTIFICÄ‚RILE
                        </button>
                    </div>
                </div>
            </div>

            <div class="tab-pane fade" id="read">
                <div class="card-premium p-2 mb-2">
                    <div class="input-group input-group-sm">
                        <span class="input-group-text bg-transparent border-0"><i class="fas fa-search text-muted"></i></span>
                        <input type="text" id="search-bible" class="form-control border-0" placeholder="CautÄƒ un cuvÃ¢nt Ã®n toatÄƒ Biblia..." onkeyup="if(event.key==='Enter') cautaGlobal()">
                        <button class="btn btn-sm btn-primary rounded-pill px-3 ms-1" onclick="cautaGlobal()">CautÄƒ</button>
                    </div>
                    <div id="search-results-box">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="small fw-bold text-primary" id="search-count"></span>
                            <button class="btn btn-sm p-0" onclick="document.getElementById('search-results-box').style.display='none'"><i class="fas fa-times text-danger"></i></button>
                        </div>
                        <div id="search-results-list"></div>
                    </div>
                </div>
                <div class="controls-reader text-center mb-2">
                    <button class="btn-circle d-inline-flex" onclick="changeFontSize(-2)">A-</button>
                    <button class="btn-circle d-inline-flex ms-2" onclick="changeFontSize(2)">A+</button>
                </div>
                <div class="card-premium p-2 mb-2 sticky-top" style="top: 60px; z-index: 5;">
                    <div class="input-group input-group-sm mb-2">
                        <span class="input-group-text bg-transparent border-0"><i class="fas fa-bolt text-warning"></i></span>
                        <input type="text" id="quick-go" class="form-control border-0 shadow-none" placeholder="Mergi la... (ex: Ioan 3:16)" onkeyup="if(event.key==='Enter') smartGo()">
                        <button class="btn btn-sm btn-outline-primary border-0" onclick="smartGo()">GO</button>
                    </div>

                    <div class="d-flex gap-1 mb-2" style="overflow-x: auto; white-space: nowrap; padding-bottom: 5px; scrollbar-width: none;">
                        <button class="btn btn-xs btn-light rounded-pill border py-0 px-2" style="font-size: 0.65rem;" onclick="quickLink('Psalmii 23')">Ps. 23</button>
                        <button class="btn btn-xs btn-light rounded-pill border py-0 px-2" style="font-size: 0.65rem;" onclick="quickLink('Matei 6:9')">TatÄƒl Nostru</button>
                        <button class="btn btn-xs btn-light rounded-pill border py-0 px-2" style="font-size: 0.65rem;" onclick="quickLink('1 Corinteni 13')">Iubirea</button>
                        <button class="btn btn-xs btn-light rounded-pill border py-0 px-2" style="font-size: 0.65rem;" onclick="quickLink('Ioan 1')">CuvÃ¢ntul</button>
                        <button class="btn btn-xs btn-light rounded-pill border py-0 px-2" style="font-size: 0.65rem;" onclick="quickLink('Efeseni 6:10')">Armura</button>
                    </div>

                    <hr class="my-1 opacity-25">
                    
                    <div class="d-flex gap-1">
                        <select id="sel-c" class="form-select form-select-sm" onchange="updateCap()"></select>
                        <select id="sel-cap" class="form-select form-select-sm" onchange="showCap()"></select>
                        <select id="sel-v" class="form-select form-select-sm" onchange="sariLaVerset()"></select>
                    </div>
                    <button onclick="bifeazaCapitol()" class="btn btn-sm btn-outline-success rounded-pill mt-2 w-100" style="font-size: 0.75rem;">
                        <i class="fas fa-check-circle me-1"></i> AM CITIT ACEST CAPITOL
                    </button>
                </div>
                <div id="citire-text" class="card-premium">SelecteazÄƒ o carte.</div>
            </div>

            <div class="tab-pane fade" id="saved">
                <div class="p-2"> 
                    <h5 class="fw-bold mb-3"><i class="fas fa-bookmark me-2 text-danger"></i>Versete Salvate</h5>
                    <div id="lista-salvate"></div>
                </div>
            </div>

            <div class="tab-pane fade" id="quiz">
                <div id="quiz-login" class="card-premium text-center">
                    <h6 class="fw-bold mb-3">Introdu numele tÄƒu</h6>
                    <input type="text" id="user-name" class="form-control mb-3 text-center rounded-pill" placeholder="Numele tÄƒu">
                    <button onclick="showDifficulty()" class="btn btn-primary w-100 rounded-pill fw-bold py-2">CONTINUÄ‚</button>
                </div>

                <div id="quiz-difficulty" class="card-premium text-center d-none">
                    <h6 class="fw-bold mb-4">Alege nivelul de dificultate</h6>
                    <button onclick="startQuizFlow('usor')" class="diff-btn"><i class="fas fa-leaf text-success me-2"></i> UÈ˜OR</button>
                    <button onclick="startQuizFlow('mediu')" class="diff-btn"><i class="fas fa-mountain text-warning me-2"></i> MEDIU</button>
                    <button onclick="startQuizFlow('avansat')" class="diff-btn"><i class="fas fa-fire text-danger me-2"></i> AVANSAT</button>
                </div>

                <div id="quiz-box" class="card-premium d-none">
                    <div class="d-flex justify-content-between align-items-center mb-3 border-bottom pb-2">
                        <span id="player-display" class="fw-bold text-primary small"></span>
                        <div class="d-flex gap-3">
                            <span class="timer-box"><i class="fas fa-clock me-1"></i><span id="quiz-timer">00:00</span></span>
                            <span id="score-display" class="score-box small"><i class="fas fa-star me-1 text-warning"></i>Scor: 0</span>
                        </div>
                    </div>
                    <div id="quiz-content"> 
                        <div class="d-flex justify-content-end mb-2"><span id="q-count" class="badge bg-light text-dark shadow-sm"></span></div>
                        <div id="q-txt" class="fw-bold mb-3"></div>
                        <div id="q-opts" class="mt-3"></div>
                        <div id="q-res" class="mt-3" style="min-height: 50px;"></div>
                        <hr>
                        <button onclick="veziRezultate()" class="btn btn-light btn-sm w-100 text-muted small"><i class="fas fa-history me-1"></i> Vezi istoricul meu</button>
                    </div>
                    <div id="tabel-rezultate" class="mt-4 d-none">
                        <h6 class="fw-bold border-bottom pb-2 text-center"><i class="fas fa-award text-warning me-2"></i>Activitate RecentÄƒ</h6>
                        <button onclick="restartQuiz()" class="btn btn-primary w-100 rounded-pill fw-bold mb-3">
                            <i class="fas fa-redo me-2"></i>REÃŽNCEPE QUIZ-UL
                        </button>
                        <div id="lista-scoruri-container" style="max-height: 400px; overflow-y: auto; padding: 5px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // --- SERVICE WORKER REGISTRATION ---
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('sw.js').then(reg => console.log('SW Registered'));
        });
    }

    const SUPABASE_BASE_URL = "https://tlfvklpexmglgkhuxyxp.supabase.co/rest/v1"; 
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRsZnZrbHBleG1nbGdraHV4eXhwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE4NjIxMjgsImV4cCI6MjA4NzQzODEyOH0.Vj7b_VsE9jCU5j3vW7EaOb2MGeWL8cbYPkkI3kuPeMY";

    let userName = "", score = 0, quizBlocat = false, intrebariSession = [], pasActual = 0;
    let currentFontSize = 16;
    let timerInterval, secundeScurse = 0;
    let audioCtx = null;
    let ultimaStareSelectata = "";

    // NOU: FuncÈ›ii pentru Smart Go È™i Quick Links
    function quickLink(ref) {
        document.getElementById('quick-go').value = ref;
        smartGo();
    }

    function smartGo() {
    const input = document.getElementById('quick-go').value.trim();
    if (!input) return;

    // Regex care acceptÄƒ: "Nume" "Capitol" sau "Nume" "Capitol:Verset"
    const regex = /^(\d?\s?[a-zA-ZÄƒÃ®Ã¢È™È›Ä‚ÃŽÃ‚È˜Èš\s\.]+)\s(\d+)(?:\s?[:\s]\s?(\d+))?$/i;
    const match = input.match(regex);

    if (match) {
        let textCarteIntrodus = match[1].toLowerCase().trim();
        const capCautat = match[2];
        const versetCautat = match[3];

        const selectCarte = document.getElementById('sel-c');
        let indexGasit = -1;

        // PARTE DE DESTEPTACIUNE: CÄƒutÄƒm Ã®n lista de opÈ›iuni a selectului
        for (let i = 0; i < selectCarte.options.length; i++) {
            let numeCarteDinBiblie = selectCarte.options[i].value.toLowerCase();
            
            // VerificÄƒm dacÄƒ ce a scris utilizatorul se potriveÈ™te cu Ã®nceputul unei cÄƒrÈ›i
            // Exemplu: "1 cor" se va potrivi cu "1 corinteni"
            // Exemplu: "efes" se va potrivi cu "efeseni"
            if (numeCarteDinBiblie.startsWith(textCarteIntrodus) || textCarteIntrodus.startsWith(numeCarteDinBiblie)) {
                indexGasit = i;
                break;
            }
        }

        if (indexGasit !== -1) {
            selectCarte.selectedIndex = indexGasit;
            updateCap(); // ÃŽncarcÄƒ capitolele pentru cartea gÄƒsitÄƒ
            
            const selectCap = document.getElementById('sel-cap');
            // VerificÄƒm dacÄƒ capitolul existÄƒ
            if ([...selectCap.options].some(opt => opt.value == capCautat)) {
                selectCap.value = capCautat;
                showCap(); // AfiÈ™eazÄƒ textul capitolului

                if (versetCautat) {
                    setTimeout(() => {
                        const selectVerset = document.getElementById('sel-v');
                        if ([...selectVerset.options].some(opt => opt.value == versetCautat)) {
                            selectVerset.value = versetCautat;
                            sariLaVerset();
                        }
                    }, 300);
                }
                document.getElementById('quick-go').value = ""; 
            } else {
                alert("Cartea are mai puÈ›ine capitole decÃ¢t " + capCautat);
            }
        } else { 
            alert("Nu am gÄƒsit nicio carte care sÄƒ Ã®nceapÄƒ cu '" + textCarteIntrodus + "'"); 
        }
    } else { 
        alert("Format incorect. FoloseÈ™te: 'Carte Capitol:Verset' (ex: Romani 8:1)"); 
    }
}

    function cautaGlobal() {
        let input = document.getElementById('search-bible').value.trim();
        if (input.length < 3) { alert("Introdu cel puÈ›in 3 litere."); return; }

        // 1. VerificÄƒm dacÄƒ este o referinÈ›Äƒ (ex: "Ioan 3:16" sau "Geneza 2")
        const regexRef = /^(\d?\s?[a-zA-ZÄƒÃ®Ã¢È™È›Ä‚ÃŽÃ‚È˜Èš\s\.]+)\s(\d+)(?:\s?[:\s]\s?(\d+))?$/i;
        const esteReferinta = input.match(regexRef);

        if (esteReferinta) {
            // DacÄƒ e referinÈ›Äƒ, trimitem textul la smartGo() È™i ne oprim
            document.getElementById('quick-go').value = input;
            smartGo();
            document.getElementById('search-bible').value = "";
            return; 
        }

        // 2. DacÄƒ NU e referinÈ›Äƒ, facem cÄƒutarea normalÄƒ de cuvinte
        let query = input.toLowerCase();
        const resBox = document.getElementById('search-results-box');
        const resList = document.getElementById('search-results-list');
        const resCount = document.getElementById('search-count');
        
        let rezultate = bibleData.verses.filter(v => v.text.toLowerCase().includes(query));
        
        resList.innerHTML = "";
        resBox.style.display = "block";
        resCount.innerText = `Am gÄƒsit ${rezultate.length} rezultate pentru "${input}":`;
        
        if (rezultate.length === 0) { 
            resList.innerHTML = "<p class='small text-muted'>Niciun rezultat gÄƒsit.</p>"; 
            return; 
        }

        resList.innerHTML = rezultate.map(v => {
            const ref = `${v.book_name} ${v.chapter}:${v.verse}`;
            const textEvidentiat = v.text.replace(new RegExp(query, 'gi'), match => `<mark>${match}</mark>`);
            return `
                <div class="search-item" onclick="navigheazaLaRef('${ref}')">
                    <div class="ref-link" style="font-size: 0.7rem;">${ref}</div>
                    <div class="small" style="line-height: 1.3;">${textEvidentiat}</div>
                </div>`;
        }).join('');
    }

    // --- LOGICA NOTIFICARI ---
    const inputOra = document.getElementById('oraNotificare');
    if (inputOra) {
        const oraSalvata = localStorage.getItem('ora_notificare') || "06:00";
        inputOra.value = oraSalvata;
        inputOra.addEventListener('change', () => { localStorage.setItem('ora_notificare', inputOra.value); });
    }

    function activeazaNotificari() {
        if (!("Notification" in window)) { alert("NotificÄƒrile nu sunt suportate."); return; }
        Notification.requestPermission().then(permission => {
            if (permission === "granted") {
                localStorage.setItem('notificari_active', 'true');
                actualizeazaInterfataNotificari();
                trimiteNotificareLocala("NotificÄƒri activate!", "Vei primi versetul zilnic la ora setatÄƒ.");
            }
        });
    }

    function actualizeazaInterfataNotificari() {
        const btn = document.getElementById('btn-notificare');
        if(btn && localStorage.getItem('notificari_active') === 'true' && Notification.permission === "granted") {
            btn.innerText = "NOTIFICÄ‚RI ACTIVE âœ…";
            btn.classList.replace('btn-primary', 'btn-success');
        }
    }

    function trimiteNotificareLocala(titlu, text) {
        if (Notification.permission === "granted") {
            const v = bibleData.verses[Math.floor(Math.random() * bibleData.verses.length)];
            navigator.serviceWorker.ready.then(registration => {
                registration.showNotification(titlu || "Versetul Zilei", {
                    body: text || `"${v.text}" - ${v.book_name} ${v.chapter}:${v.verse}`,
                    icon: "https://cdn-icons-png.flaticon.com/512/3389/3389381.png",
                    badge: "https://cdn-icons-png.flaticon.com/512/3389/3389381.png",
                    vibrate: [200, 100, 200],
                    tag: 'verset-zilnic',
                    renotify: true
                });
            });
        }
    }

    setInterval(() => {
        const acum = new Date();
        const oraSetataUtilizator = localStorage.getItem('ora_notificare') || "06:00";
        const [ora, minut] = oraSetataUtilizator.split(':').map(Number);
        const azi = acum.toDateString();
        if (acum.getHours() === ora && acum.getMinutes() === minut && localStorage.getItem('notificari_active') === 'true' && localStorage.getItem('ultima_notificare') !== azi) {
            trimiteNotificareLocala();
            localStorage.setItem('ultima_notificare', azi);
        }
    }, 60000);

    function bifeazaCapitol() {
        const carte = document.getElementById('sel-c').value;
        const cap = document.getElementById('sel-cap').value;
        const idCap = `${carte}-${cap}`;
        let parcurse = JSON.parse(localStorage.getItem('capitole_citite') || '[]');
        if (!parcurse.includes(idCap)) {
            parcurse.push(idCap);
            localStorage.setItem('capitole_citite', JSON.stringify(parcurse));
            alert("Capitol marcat ca citit!");
            actualizeazaProgres();
        } else { alert("Ai citit deja acest capitol."); }
    }

    function actualizeazaProgres() {
        const parcurse = JSON.parse(localStorage.getItem('capitole_citite') || '[]').length;
        const totalCapitole = 1189;
        const procent = (parcurse / totalCapitole * 100).toFixed(1);
        const bar = document.getElementById('biblie-progres-bar');
        const txt = document.getElementById('progres-text');
        if(bar) bar.style.width = procent + "%";
        if(txt) txt.innerText = `${parcurse} din ${totalCapitole} capitole (${procent}%)`;
    }

    function verificaOraNoapte() {
        const ora = new Date().getHours();
        const card = document.getElementById('card-noapte');
        const text = document.getElementById('text-noapte');
        if (ora >= 21 || ora <= 5) {
            const verseteNoapte = [
                "ÃŽn pace mÄƒ voi culca ÅŸi voi adormi Ã®ndatÄƒ, cÄƒci numai Tu, Doamne, Ã®mi dai liniÅŸte Ã®n locuinÅ£a mea. (Psalmi 4:8)",
                "CÃ¢nd te vei culca, vei fi fÄƒrÄƒ teamÄƒ; ÅŸi cÃ¢nd vei dormi, somnul Ã®Å£i va fi dulce. (Proverbe 3:24)",
                "Nu te teme, cÄƒci Eu sunt cu tine; nu te uita cu Ã®ngrijorare, cÄƒci Eu sunt Dumnezeul tÄƒu. (Isaia 41:10)"
            ];
            if(card) {
                card.style.display = 'block';
                text.innerText = verseteNoapte[Math.floor(Math.random() * verseteNoapte.length)];
            }
        }
    }

    function goToFeature(feature) {
        const welcome = document.getElementById('welcome-screen');
        welcome.style.transform = "translateY(-100%)";
        document.getElementById('main-app-content').style.opacity = "1";
        if (feature === 'read') {
            const trigger = document.getElementById('btn-read');
            const tab = new bootstrap.Tab(trigger);
            tab.show();
            initRead();
        } else if (feature === 'quiz') {
            const trigger = document.getElementById('btn-quiz');
            const tab = new bootstrap.Tab(trigger);
            tab.show();
        }
        setTimeout(() => { welcome.style.display = "none"; }, 800);
    }

    function playFeedback(corect) {
        if (navigator.vibrate) navigator.vibrate(corect ? 50 : [100, 50, 100]);
        if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        osc.connect(g);
        g.connect(audioCtx.destination);
        osc.frequency.setValueAtTime(corect ? 880 : 220, audioCtx.currentTime);
        g.gain.setValueAtTime(0.15, audioCtx.currentTime); 
        g.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.4);
        osc.start();
        osc.stop(audioCtx.currentTime + 0.4);
    }

    function playFanfare() {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const notes = [523.25, 659.25, 783.99, 1046.50];
        notes.forEach((freq, i) => {
            const osc = ctx.createOscillator();
            const g = ctx.createGain();
            osc.frequency.value = freq;
            osc.connect(g);
            g.connect(ctx.destination);
            const startTime = ctx.currentTime + (i * 0.15);
            g.gain.setValueAtTime(0, startTime);
            g.gain.linearRampToValueAtTime(0.1, startTime + 0.1);
            g.gain.exponentialRampToValueAtTime(0.001, startTime + 0.8);
            osc.start(startTime);
            osc.stop(startTime + 0.9);
        });
    }

    function restartQuiz() {
        document.getElementById('quiz-box').classList.add('d-none');
        document.getElementById('tabel-rezultate').classList.add('d-none');
        pasActual = 0; score = 0; secundeScurse = 0;
        document.getElementById('quiz-difficulty').classList.remove('d-none');
    }

    function showDifficulty() {
        const input = document.getElementById('user-name');
        if(input.value.trim().length < 2) return;
        userName = input.value.trim();
        document.getElementById('quiz-login').classList.add('d-none');
        document.getElementById('quiz-difficulty').classList.remove('d-none');
    }

    function startQuizFlow(nivel) {
        pasActual = 0; score = 0;
        document.getElementById('score-display').innerHTML = `<i class="fas fa-star me-1 text-warning"></i>Scor: 0`;
        let colectie = [];
        if(nivel === 'usor') { colectie = intrebariBiblice.filter((_, i) => [1, 2, 5, 7, 10, 12, 14, 18, 19, 26].includes(i));
        } else if(nivel === 'mediu') { colectie = intrebariBiblice.filter((_, i) => [0, 3, 4, 6, 8, 9, 11, 13, 20, 29].includes(i));
        } else if(nivel === 'avansat') { colectie = intrebariBiblice.filter((_, i) => [15, 16, 17, 21, 22, 23, 24, 25, 27, 28].includes(i)); }
        intrebariSession = [...colectie].sort(() => 0.5 - Math.random());
        document.getElementById('quiz-difficulty').classList.add('d-none');
        document.getElementById('quiz-box').classList.remove('d-none');
        document.getElementById('player-display').innerText = "ðŸ‘¤ " + userName;
        startTimer();
        startQuiz();
    }

    function startTimer() {
        secundeScurse = 0;
        clearInterval(timerInterval);
        timerInterval = setInterval(() => {
            secundeScurse++;
            const m = Math.floor(secundeScurse / 60).toString().padStart(2, '0');
            const s = (secundeScurse % 60).toString().padStart(2, '0');
            document.getElementById('quiz-timer').innerText = `${m}:${s}`;
        }, 1000);
    }

    function startQuiz() {
        if (pasActual >= intrebariSession.length) { 
            clearInterval(timerInterval);
            playFanfare();
            veziRezultate(); 
            return; 
        }
        quizBlocat = false;
        const intr = intrebariSession[pasActual];
        document.getElementById('q-count').innerText = (pasActual + 1) + "/" + intrebariSession.length;
        document.getElementById('q-txt').innerText = (pasActual + 1) + ". " + intr.q;
        const od = document.getElementById('q-opts');
        od.innerHTML = "";
        intr.a.forEach((raspuns, index) => {
            let b = document.createElement('button');
            b.className = "quiz-btn shadow-sm";
            b.innerText = raspuns;
            b.onclick = () => {
                if(quizBlocat) return;
                quizBlocat = true;
                let esteCorect = (index === intr.c);
                playFeedback(esteCorect);
                if(esteCorect) { 
                    score++; 
                    b.style.background = "#28a745"; b.style.color = "white"; b.style.borderColor = "var(--s)"; 
                } else { 
                    b.style.background = "#dc3545"; b.style.color = "white"; b.style.borderColor = "var(--a)"; 
                }
                document.getElementById('score-display').innerHTML = `<i class="fas fa-star me-1 text-warning"></i>Scor: ${score}`;
                trimiteDate(intr.q, esteCorect ? "Corect" : "Gresit", intr.r, raspuns);
                pasActual++; 
                setTimeout(startQuiz, 1500);
            };
            od.appendChild(b);
        });
    }

    async function trimiteDate(intrebare, rezultat, referinta, raspunsAles) {
        try {
            await fetch(`${SUPABASE_BASE_URL}/scoruri`, {
                method: "POST",
                headers: { "apikey": SUPABASE_KEY, "Authorization": `Bearer ${SUPABASE_KEY}`, "Content-Type": "application/json" },
                body: JSON.stringify({ nume: userName, intrebare, rezultat, referinta, raspuns_ales: raspunsAles })
            });
        } catch (e) {}
    }

    async function veziRezultate() {
        const container = document.getElementById('lista-scoruri-container');
        document.getElementById('tabel-rezultate').classList.remove('d-none');
        container.innerHTML = "<div class='text-center py-3'>Se Ã®ncarcÄƒ...</div>";
        try {
            const res = await fetch(`${SUPABASE_BASE_URL}/scoruri?nume=eq.${encodeURIComponent(userName)}&order=id.desc&limit=30`, { 
                headers: { "apikey": SUPABASE_KEY, "Authorization": `Bearer ${SUPABASE_KEY}` } 
            });
            const date = await res.json();
            container.innerHTML = date.map(rand => `
                <div class="history-item ${rand.rezultat === 'Corect' ? 'history-correct' : 'history-wrong'} shadow-sm">
                    <div class="pe-2">
                        <div class="fw-bold small">${rand.intrebare}</div>
                        <div class="text-muted" style="font-size: 0.7rem;">Ai ales: ${rand.raspuns_ales}</div>
                        ${rand.rezultat !== 'Corect' ? `<div class="ref-link" onclick="navigheazaLaRef('${rand.referinta}')">${rand.referinta}</div>` : ''}
                    </div>
                </div>`).join('');
        } catch (e) { container.innerHTML = "Eroare."; }
    }

    function navigheazaLaRef(ref) {
        const parts = ref.match(/^(.+?)\s(\d+):(\d+)/);
        if(!parts) return;
        const trigger = document.getElementById('btn-read');
        const tab = new bootstrap.Tab(trigger);
        tab.show();
        initRead();
        const selectCarte = document.getElementById('sel-c');
        const searchName = parts[1].toLowerCase();
        for (let i = 0; i < selectCarte.options.length; i++) {
            if (selectCarte.options[i].value.toLowerCase().includes(searchName) || searchName.includes(selectCarte.options[i].value.toLowerCase())) {
                selectCarte.selectedIndex = i;
                break;
            }
        }
        updateCap();
        document.getElementById('sel-cap').value = parts[2];
        showCap();
        setTimeout(() => { document.getElementById('sel-v').value = parts[3]; sariLaVerset(); }, 400);
    }

    function toggleTheme() {
        document.body.classList.toggle('dark-theme');
        const isDark = document.body.classList.contains('dark-theme');
        document.querySelector('header button i').className = isDark ? 'fas fa-sun' : 'fas fa-moon';
    }

    function changeFontSize(delta) {
        currentFontSize += delta;
        document.getElementById('citire-text').style.fontSize = currentFontSize + "px";
    }

    function copyVerse() {
        const text = document.getElementById('rand-text').innerText;
        const ref = document.getElementById('rand-ref').innerText;
        navigator.clipboard.writeText(`"${text}" (${ref}) - Biblia Pro`).then(() => alert("Copiat!"));
    }

    function salveazaVerset(book, cap, vNum, text) {
        let s = JSON.parse(localStorage.getItem('biblia_salvate') || '[]');
        const ref = `${book} ${cap}:${vNum}`;
        if (!s.some(x => x.ref === ref)) {
            s.push({ ref, text, culoare: 'var(--card)', nota: '' });
            localStorage.setItem('biblia_salvate', JSON.stringify(s));
            alert("Salvat Ã®n colecÈ›ie!");
        }
    }

    function afiseazaSalvate() {
        const container = document.getElementById('lista-salvate');
        let s = JSON.parse(localStorage.getItem('biblia_salvate') || '[]');
        if (s.length === 0) { 
            container.innerHTML = '<p class="text-muted small">Niciun verset salvat Ã®ncÄƒ.</p>'; 
            return; 
        }
        
        const culori = [
            { nume: 'Implicit', cod: 'var(--card)' },
            { nume: 'Galben', cod: '#fff9c4' },
            { nume: 'Verde', cod: '#c8e6c9' },
            { nume: 'Albastru', cod: '#bbdefb' },
            { nume: 'Roz', cod: '#f8bbd0' }
        ];

        container.innerHTML = s.map((v, i) => {
            let bgStyle = v.culoare || 'var(--card)';
            let isDarkTheme = document.body.classList.contains('dark-theme');
            let textStyle = (isDarkTheme && bgStyle === 'var(--card)') ? '#e0e0e0' : '#2c3e50';

            return `
            <div id="card-salvat-${i}" class="card-premium mb-3 p-3 shadow-sm" style="background-color: ${bgStyle}; border-left: 5px solid var(--a); color: ${textStyle}">
                <div class="d-flex justify-content-between align-items-start mb-2">
                    <div class="ref-link" onclick="navigheazaLaRef('${v.ref}')" style="font-size: 0.9rem;">${v.ref}</div>
                    <div class="dropdown">
                        <button class="btn btn-sm p-0" data-bs-toggle="dropdown"><i class="fas fa-palette text-muted"></i></button>
                        <ul class="dropdown-menu shadow">
                            ${culori.map(c => `<li><a class="dropdown-item small" href="#" onclick="schimbaCuloareaVerset(${i}, '${c.cod}')">${c.nume}</a></li>`).join('')}
                        </ul>
                    </div>
                </div>
                <div class="small mb-2 fst-italic" style="line-height: 1.4;">"${v.text}"</div>
                <textarea class="note-input mb-2" placeholder="NotiÈ›e / GÃ¢nduri..." 
                    onchange="salveazaNota(${i}, this.value)">${v.nota || ''}</textarea>
                
                <div class="d-flex justify-content-between align-items-center border-top pt-2">
                    <button onclick="stergeVerset(${i})" class="btn btn-sm text-danger p-0" style="font-size:0.75rem;"><i class="fas fa-trash me-1"></i>È˜terge</button>
                    <button onclick="shareAsCard(${i})" class="btn btn-sm btn-primary rounded-pill px-3" style="font-size:0.7rem;"><i class="fas fa-share-alt me-1"></i> TRIMITE CARD</button>
                </div>
            </div>`;
        }).join('');
    }

    function schimbaCuloareaVerset(index, culoare) {
        let s = JSON.parse(localStorage.getItem('biblia_salvate') || '[]');
        if(s[index]) {
            s[index].culoare = culoare;
            localStorage.setItem('biblia_salvate', JSON.stringify(s));
            afiseazaSalvate();
        }
    }

    function shareAsCard(index) {
        let s = JSON.parse(localStorage.getItem('biblia_salvate') || '[]');
        const v = s[index];
        const textShare = `ðŸ“– BIBLIA PRO\n\n"${v.text}"\n\nRef: ${v.ref}\n${v.nota ? 'GÃ¢nd: ' + v.nota : ''}`;
        
        if (navigator.share) {
            navigator.share({ title: 'Verset Salvat', text: textShare }).catch(() => copyToClipboard(textShare));
        } else {
            copyToClipboard(textShare);
        }
    }

    function copyToClipboard(text) {
        navigator.clipboard.writeText(text).then(() => alert("Textul cardului a fost copiat!"));
    }

    function salveazaNota(index, valoare) {
        let s = JSON.parse(localStorage.getItem('biblia_salvate') || '[]');
        if(s[index]) {
            s[index].nota = valoare;
            localStorage.setItem('biblia_salvate', JSON.stringify(s));
        }
    }

    function stergeVerset(i) {
        if(confirm("È˜tergi acest verset?")) {
            let s = JSON.parse(localStorage.getItem('biblia_salvate') || '[]');
            s.splice(i, 1);
            localStorage.setItem('biblia_salvate', JSON.stringify(s));
            afiseazaSalvate();
        }
    }

    function initRead() {
        const sc = document.getElementById('sel-c');
        if (sc.options.length > 0) return;
        [...new Set(bibleData.verses.map(v => v.book_name))].forEach(c => sc.add(new Option(c, c)));
        updateCap();
    }

    function updateCap() {
        const c = document.getElementById('sel-c').value;
        const caps = [...new Set(bibleData.verses.filter(v => v.book_name === c).map(v => v.chapter))];
        const sc = document.getElementById('sel-cap'); sc.innerHTML = "";
        caps.forEach(cp => sc.add(new Option("Cap. " + cp, cp)));
        showCap();
    }

    function showCap() {
        const c = document.getElementById('sel-c').value;
        const cp = document.getElementById('sel-cap').value;
        const vers = bibleData.verses.filter(v => v.book_name === c && v.chapter == cp);
        document.getElementById('sel-v').innerHTML = '<option value="">Verset...</option>';
        vers.forEach(v => document.getElementById('sel-v').add(new Option("V. " + v.verse, v.verse)));
        document.getElementById('citire-text').innerHTML = vers.map(v => `
            <span id="v-${v.verse}" class="verset-wrapper" onclick="evidentiazaVerset(this)">
                <b style="color:var(--a); font-size:0.8rem;">${v.verse}</b> ${v.text}
                <i class="fas fa-bookmark ms-1 text-muted" style="font-size:0.7rem; cursor:pointer;" onclick="salveazaVerset('${v.book_name}', ${v.chapter}, ${v.verse}, '${v.text.replace(/'/g, "\\'")}')"></i>
            </span>`).join(' ');
    }

    function evidentiazaVerset(el) {
        document.querySelectorAll('.verset-wrapper').forEach(v => v.classList.remove('highlight'));
        el.classList.add('highlight');
    }

    function sariLaVerset() {
        const v = document.getElementById('sel-v').value;
        const el = document.getElementById(`v-${v}`);
        if(el) { el.scrollIntoView({ behavior: 'smooth', block: 'center' }); evidentiazaVerset(el); }
    }

    function genereazaVerset() {
        if (typeof bibleData !== 'undefined') {
            const v = bibleData.verses[Math.floor(Math.random() * bibleData.verses.length)];
            document.getElementById('rand-text').innerText = v.text;
            document.getElementById('rand-ref').innerText = v.book_name + " " + v.chapter + ":" + v.verse;
        }
    }

    function vStare(stare) {
        if (stare) ultimaStareSelectata = stare;
        const stareActiva = stare || ultimaStareSelectata;
        const bazeStari = {
            'neliniÈ™tit': ["Filipeni 4:6", "1 Petru 5:7", "Matei 6:34", "Psalmi 94:19", "Ioan 14:27"],
            'trist': ["Psalmi 34:18", "Ioan 14:1", "Apocalipsa 21:4", "Psalmi 147:3", "Matei 5:4"],
            'recunoscÄƒtor': ["Psalmi 107:1", "1 Tesaloniceni 5:18", "Coloseni 3:15", "Psalmi 100:4", "Efeseni 5:20"],
            'obosit': ["Matei 11:28", "Isaia 40:31", "Psalmi 62:1", "Psalmi 23:2", "Galateni 6:9"]
        };
        let refs = bazeStari[stareActiva];
        let refAleasa = refs[Math.floor(Math.random() * refs.length)];
        const match = refAleasa.match(/(.+)\s(\d+):(\d+)/);
        if(match) {
            const cName = match[1].toLowerCase();
            const cap = parseInt(match[2]);
            const ver = parseInt(match[3]);
            const vGasit = bibleData.verses.find(v => (v.book_name.toLowerCase().includes(cName) || cName.includes(v.book_name.toLowerCase())) && v.chapter == cap && v.verse == ver);
            const container = document.getElementById('stare-rezultat-container');
            const divText = document.getElementById('stare-rezultat');
            const btnAltul = document.getElementById('btn-alt-verset-stare');
            container.classList.remove('d-none');
            divText.classList.remove('fade-in-v');
            void divText.offsetWidth; 
            divText.classList.add('fade-in-v');
            divText.innerHTML = `<span class="ref-link" onclick="navigheazaLaRef('${refAleasa}')">${refAleasa}</span>: "${vGasit ? vGasit.text : 'Versetul se Ã®ncarcÄƒ...'}"`;
            btnAltul.onclick = () => vStare();
        }
    }

    window.addEventListener('load', () => {
        genereazaVerset();
        actualizeazaInterfataNotificari();
        actualizeazaProgres(); 
        verificaOraNoapte();  
    });

    const intrebariBiblice = [
        { q: "Cine l-a trÄƒdat pe Isus pentru 30 de arginÈ›i?", a: ["Iuda Iscarioteanul", "Petru", "Ioan", "Toma"], c: 0, r: "Matei 26:14" },
        { q: "Unde S-a nÄƒscut Isus Hristos?", a: ["Ierusalim", "Nazaret", "Betleem", "Ierihon"], c: 2, r: "Matei 2:1" },
        { q: "Moise a despÄƒrÈ›it apele MÄƒrii RoÈ™ii.", a: ["AdevÄƒrat", "Fals"], c: 0, r: "Exod 14:21" },
        { q: "CÃ¢te zile a plouat Ã®n timpul potopului lui Noe?", a: ["7 zile", "12 zile", "40 de zile", "100 de zile"], c: 2, r: "Geneza 7:12" },
        { q: "Care a fost prima minune a lui Isus?", a: ["Vindecarea", "PÃ¢inile", "Apa Ã®n vin", "Mersul pe apÄƒ"], c: 2, r: "Ioan 2:11" },
        { q: "Cine l-a ucis pe uriaÈ™ul Goliat?", a: ["Saul", "David", "Samson", "Ghedeon"], c: 1, r: "1 Samuel 17:50" },
        { q: "CÃ¢È›i ucenici principali a avut Isus?", a: ["10", "12", "7", "40"], c: 1, r: "Matei 10:1" },
        { q: "Care este prima carte a Biblia?", a: ["Exod", "Levitic", "Geneza", "Psalmi"], c: 2, r: "Geneza 1:1" },
        { q: "Cine a fost aruncat Ã®n groapa cu lei?", a: ["Iov", "Daniel", "Iona", "Iosif"], c: 1, r: "Daniel 6:16" },
        { q: "Pe ce mare a umblat Isus pe jos?", a: ["Marea RoÈ™ie", "Marea MoartÄƒ", "Marea Galileii", "Marea MediteranÄƒ"], c: 2, r: "Matei 14:25" },
        { q: "Cine a primit Cele Zece Porunci?", a: ["Avraam", "Isaac", "Moise", "Iacov"], c: 2, r: "Exod 20:1" },
        { q: "Care era ocupaÈ›ia lui Petru Ã®nainte de a deveni ucenic?", a: ["VameÈ™", "TÃ¢mplar", "Pescar", "PÄƒstor"], c: 2, r: "Matei 4:18" },
        { q: "Cine a construit corabia pentru potop?", a: ["Enoh", "Noe", "Lameh", "Matusalem"], c: 1, r: "Geneza 6:14" },
        { q: "Cum se numea muntele unde a fost rÄƒstignit Isus?", a: ["Sinai", "Golgota", "Horeb", "Tabor"], c: 1, r: "Matei 27:33" },
        { q: "Cine a fost soÈ›ia lui Adam?", a: ["Sara", "Rahela", "Eva", "Estera"], c: 2, r: "Geneza 3:20" },
        { q: "CÃ¢te urgii au lovit Egiptul?", a: ["7", "12", "10", "3"], c: 2, r: "Exod 7:1" },
        { q: "Cine a fost cel mai Ã®nÈ›elept rege al Israelului?", a: ["Saul", "David", "Solomon", "Ezechia"], c: 2, r: "1 Imparati 3:12" },
        { q: "ÃŽn ce oraÈ™ au fost numiÈ›i ucenicii 'creÈ™tini' prima datÄƒ?", a: ["Ierusalim", "Antiohia", "Roma", "Efes"], c: 1, r: "Fapte 11:26" },
        { q: "Cine l-a botezat pe Isus?", a: ["Petru", "Ioan BotezÄƒtorul", "Pavel", "Iacov"], c: 1, r: "Matei 3:13" },
        { q: "Care este ultima carte a Bibliei?", a: ["Evrei", "Iuda", "Apocalipsa", "Maleahi"], c: 2, r: "Apocalipsa 1:1" },
        { q: "Cine a fost fratele lui Moise?", a: ["Iosua", "Aaron", "Caleb", "Eleazar"], c: 1, r: "Exod 4:14" },
        { q: "CÃ¢te pÃ¢ini a folosit Isus pentru a hrÄƒni 5000 de oameni?", a: ["7 pÃ¢ini", "5 pÃ¢ini", "12 pÃ¢ini", "3 pÃ¢ini"], c: 1, r: "Matei 14:17" },
        { q: "Cine a scris cele mai multe epistole Ã®n Noul Testament?", a: ["Petru", "Ioan", "Pavel", "Luca"], c: 2, r: "Romani 1:1" },
        { q: "Ce animal a vorbit cu Balaam?", a: ["Un leu", "Un mÄƒgar", "Un È™arpe", "Un miel"], c: 1, r: "Numeri 22:28" },
        { q: "Cine a fost vÃ¢ndut de fraÈ›ii sÄƒi Ã®n Egipt?", a: ["Benjamin", "Iosif", "Reuben", "Simeon"], c: 1, r: "Geneza 37:28" },
        { q: "CÃ¢t timp a stat Iona Ã®n pÃ¢ntecele peÈ™telui?", a: ["1 zi", "7 zile", "3 zile È™i 3 nopÈ›i", "40 de zile"], c: 2, r: "Iona 1:17" },
        { q: "Cine a fost mama lui Isus?", a: ["Elisabeta", "Marta", "Maria", "Magdalena"], c: 2, r: "Luca 1:30" },
        { q: "Din ce a fost fÄƒcutÄƒ Eva?", a: ["Din È›ÄƒrÃ¢nÄƒ", "Dintr-o coastÄƒ", "Din aur", "Din suflare"], c: 1, r: "Geneza 2:22" },
        { q: "Cine a fost primul martir creÈ™tin?", a: ["È˜tefan", "Iacov", "Filip", "Pavel"], c: 0, r: "Fapte 7:59" },
        { q: "Ce rÃ¢u a fost folosit pentru botezul lui Isus?", a: ["Nil", "Eufrat", "Iordan", "Tigru"], c: 2, r: "Matei 3:13" }
    ];
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
